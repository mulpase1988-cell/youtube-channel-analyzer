name: ì±„ë„ ë¶„ì„ê¸°


on:
  # ë§¤ì¼ ìì • UTC (í•œêµ­ ì‹œê°„ ì˜¤ì „ 9ì‹œ) ìë™ ì‹¤í–‰
  schedule:
    - cron: '0 0 * * *'
  
  # ìˆ˜ë™ ì‹¤í–‰ ë²„íŠ¼
  workflow_dispatch:
    inputs:
      range:
        description: 'ì²˜ë¦¬ ë²”ìœ„ (ì˜ˆ: 2-50, ë¹„ìš°ë©´ ì „ì²´)'
        required: false
        type: string

jobs:
  analyze:
    runs-on: ubuntu-latest
    timeout-minutes: 360  # 6ì‹œê°„ ì œí•œ
    
    steps:
      - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v3
      
      - name: ğŸ Python ì„¤ì¹˜
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
          cache: 'pip'
      
      - name: ğŸ“¦ íŒ¨í‚¤ì§€ ì„¤ì¹˜
        run: |
          pip install --upgrade pip
          pip install -r requirements.txt
      
      - name: ğŸš€ ì±„ë„ ë¶„ì„ ì‹¤í–‰
        env:
          GOOGLE_SERVICE_ACCOUNT: ${{ secrets.GOOGLE_SERVICE_ACCOUNT }}
          SHEET_NAME: ${{ secrets.SHEET_NAME }}
          API_TAB_NAME: ${{ secrets.API_TAB_NAME }}
          DATA_TAB_NAME: ${{ secrets.DATA_TAB_NAME }}
          RANGE: ${{ inputs.range }}
        run: |
          echo "ğŸš€ ë¶„ì„ ì‹œì‘..."
          python scripts/analyzer.py
      
      - name: ğŸ“Š ê²°ê³¼ ì—…ë¡œë“œ
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: analysis-logs
          path: |
            *.log
          retention-days: 7
